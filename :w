#pragma once

#include "ir/stmt/code.h"
#include "ir/stmt/expr.h"

typedef enum {
    IR_STMT_EXPR,
    IR_STMT_STORE,
    IR_STMT_RET,
    IR_STMT_RET_VOID,
} IrStmtKind;

typedef struct {
    IrExpr value;
} IrStmtRet;

typedef struct {
    IrExpr lvalue, rvalue;
} IrStmtStore;

typedef struct {
    IrExpr cond;
    IrCode *code;
} IrStmtCondJmpBlock;

typedef struct {
    IrStmtCondJmpBlock *conds;
    IrCode *else_code;
} IrStmtCondJmp;

typedef struct IrStmt {
    IrStmtKind kind;

    union {
        IrExpr expr;
        IrStmtStore store;
        IrStmtRet ret;
    };
} IrStmt;

IrStmt *ir_stmt_new_expr(Mempool *mempool, IrExpr expr);
IrStmt *ir_stmt_new_store(Mempool *mempool, IrExpr lvalue, IrExpr rvalue);
IrStmt *ir_stmt_new_ret(Mempool *mempool, IrExpr value);
IrStmt *ir_stmt_new_ret_void(Mempool *mempool);
