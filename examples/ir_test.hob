#`
    1. create decls + types
    2. init decls + types
    2. emit func bodies
`#

#`
types = [
    SIMPLE: i32,
    ...,
    RECORD, <A>
]

decls = [
    0, // putChar
    1, // getChar
    2, // main
]
`#

extern(putchar) fun putChar(c: u8); # declId + externId
extern(getchar) fun getChar() -> u8; # declId + externId

type A = i32; # typeId(record)
              # INIT

fun isLessThan9(c: u8) -> bool {
    # should comment than function executes, try enter `/` :P
    putChar('<');
    putChar(' ');
    putChar('9');
    putChar('?');
    putChar('\n');
    return c < '9';
}

fun printAlphabets(step: u8) {
    #`
        loop {
            if a <= 'z' {
                <body>
            } else {
                break;
            }
        }
    `#
    var end: u8 = 'z';
    while.outer true {
        if end < 'a' {
            break;
        }
        var i: u8 = 'a';
        while true {
            if i > end {
                putChar('\n');
                end = end - step;
                continue outer;
            }
            putChar(i);
            i = i + 1;
        }
    }
}

global fun main() -> i32 { # declId + funcId + body
    printAlphabets(4);
    var c: u8 = getChar();
    # TODO: fix priorities
    if c >= '0' && isLessThan9(c) {
        c = c + 1;
        putChar(c);
        putChar('\n');
        return 0;
    }
    putChar('o');
    putChar('o');
    putChar('p');
    putChar('s');
    putChar('i');
    putChar('e');
    putChar('.');
    putChar('.');
    putChar('.');
    putChar('\n');
    return 1;
}

